Logging to ./meta_offloading20_log-inner_step1/
avg greedy solution:  827.8765279039657

avg all remote solution:  1449.421876051085

avg all local solution:  1409.408304042816

Traceback (most recent call last):
  File "meta_trainer.py", line 277, in <module>
    clip_value=0.3)
TypeError: __init__() got an unexpected keyword argument 'meta_sampler'
/home/mehrdad/anaconda3/envs/tf-1.15-cpu/lib/python3.6/site-packages/gym/core.py:27: UserWarning: [33mWARN: Gym minimally supports python 3.6 as the python foundation not longer supports the version, please update your version to 3.7+[0m
  "Gym minimally supports python 3.6 as the python foundation not longer supports the version, please update your version to 3.7+"
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/mehrdad/anaconda3/envs/tf-1.15-cpu/lib/python3.6/site-packages/tensorflow_core/contrib/layers/python/layers/layers.py:1866: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From tlbo_trainer.py:116: BasicLSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From tlbo_trainer.py:156: MultiRNNCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.StackedRNNCells, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From tlbo_trainer.py:218: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /home/mehrdad/anaconda3/envs/tf-1.15-cpu/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:735: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/mehrdad/anaconda3/envs/tf-1.15-cpu/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:739: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /home/mehrdad/anaconda3/envs/tf-1.15-cpu/lib/python3.6/site-packages/tensorflow_core/contrib/seq2seq/python/ops/decoder.py:420: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From tlbo_trainer.py:194: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.Dense instead.
WARNING:tensorflow:From tlbo_trainer.py:71: Categorical.__init__ (from tensorflow.python.ops.distributions.categorical) is deprecated and will be removed after 2019-01-01.
Instructions for updating:
The TensorFlow Distributions library has moved to TensorFlow Probability (https://github.com/tensorflow/probability). You should update all references to use `tfp.distributions` instead of `tf.distributions`.
WARNING:tensorflow:From /home/mehrdad/anaconda3/envs/tf-1.15-cpu/lib/python3.6/site-packages/tensorflow_core/python/ops/distributions/categorical.py:242: Distribution.__init__ (from tensorflow.python.ops.distributions.distribution) is deprecated and will be removed after 2019-01-01.
Instructions for updating:
The TensorFlow Distributions library has moved to TensorFlow Probability (https://github.com/tensorflow/probability). You should update all references to use `tfp.distributions` instead of `tf.distributions`.
WARNING:tensorflow:From /home/mehrdad/anaconda3/envs/tf-1.15-cpu/lib/python3.6/site-packages/tensorflow_core/python/ops/distributions/categorical.py:278: multinomial (from tensorflow.python.ops.random_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.random.categorical` instead.
2024-06-08 17:40:20.913542: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2024-06-08 17:40:20.921951: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2024-06-08 17:40:20.922065: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: NVIDIA GeForce RTX 3060 Laptop GPU major: 8 minor: 6 memoryClockRate(GHz): 1.425
pciBusID: 0000:01:00.0
2024-06-08 17:40:20.922119: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2024-06-08 17:40:20.922146: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2024-06-08 17:40:20.922169: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2024-06-08 17:40:20.922191: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2024-06-08 17:40:20.922213: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2024-06-08 17:40:20.922236: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2024-06-08 17:40:20.922258: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2024-06-08 17:40:20.922261: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-06-08 17:40:20.922423: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2024-06-08 17:40:20.928497: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2918400000 Hz
2024-06-08 17:40:20.929931: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5597969ac330 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2024-06-08 17:40:20.929952: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2024-06-08 17:40:20.977025: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:983] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2024-06-08 17:40:20.977306: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559795979750 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2024-06-08 17:40:20.977328: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 3060 Laptop GPU, Compute Capability 8.6
2024-06-08 17:40:20.977388: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-06-08 17:40:20.977391: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From tlbo_trainer.py:815: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

avg greedy solution:  822.6256388679877

avg all remote solution:  1288.099251163834

avg all local solution:  1430.6968247202826

avg_latency == 1100.8999968126843 -- greedy == 845.9735073446545 -- diff == -254.92648946802979 -- taskid == [16]
avg_latency == 979.2286880952835 -- greedy == 775.9840780457088 -- diff == -203.2446100495747 -- taskid == [3]
avg_latency == 1146.744203997939 -- greedy == 882.3567571518762 -- diff == -264.38744684606274 -- taskid == [12]
avg_latency == 940.480620632594 -- greedy == 782.6501557886941 -- diff == -157.8304648438999 -- taskid == [2]
avg_latency == 1053.7914807031357 -- greedy == 845.9735073446545 -- diff == -207.81797335848114 -- taskid == [16]
avg_latency == 993.3882931719779 -- greedy == 808.106911553519 -- diff == -185.2813816184589 -- taskid == [1]
avg_latency == 928.7766225254741 -- greedy == 795.2533080208642 -- diff == -133.52331450460986 -- taskid == [17]
avg_latency == 1104.8009147524017 -- greedy == 882.3567571518762 -- diff == -222.4441576005255 -- taskid == [12]
avg_latency == 822.2840624182292 -- greedy == 796.2377573818479 -- diff == -26.046305036381227 -- taskid == [18]
avg_latency == 817.11071189785 -- greedy == 801.0064184761047 -- diff == -16.104293421745297 -- taskid == [8]
avg_latency == 1168.647969371278 -- greedy == 917.1303515739442 -- diff == -251.51761779733374 -- taskid == [13]
avg_latency == 919.6282016187395 -- greedy == 808.106911553519 -- diff == -111.52129006522046 -- taskid == [1]
avg_latency == 1021.9598153928348 -- greedy == 827.8765279039657 -- diff == -194.08328748886913 -- taskid == [0]
avg_latency == 1140.0238299237253 -- greedy == 917.1303515739442 -- diff == -222.89347834978116 -- taskid == [13]
avg_latency == 876.2177254633359 -- greedy == 775.9840780457088 -- diff == -100.23364741762714 -- taskid == [3]


0


avg_latency == 818.5592339594841 -- greedy == 803.3178474461694 -- diff == -15.241386513314751 -- taskid == [10]
avg_latency == 1144.653701406656 -- greedy == 927.7099499083928 -- diff == -216.94375149826317 -- taskid == [14]
avg_latency == 1115.390691428389 -- greedy == 899.1789614620208 -- diff == -216.21172996636813 -- taskid == [15]
avg_latency == 1098.4825385129932 -- greedy == 899.1789614620208 -- diff == -199.30357705097242 -- taskid == [15]
avg_latency == 851.7695859693664 -- greedy == 775.9840780457088 -- diff == -75.78550792365763 -- taskid == [3]
avg_latency == 760.3515869631904 -- greedy == 796.2377573818479 -- diff == 35.88617041865757 -- taskid == [18]
avg_latency == 1095.5912136729512 -- greedy == 899.1789614620208 -- diff == -196.41225221093043 -- taskid == [15]
avg_latency == 799.4726574427468 -- greedy == 788.8247370971952 -- diff == -10.647920345551597 -- taskid == [4]
avg_latency == 1087.3860005699973 -- greedy == 899.1789614620208 -- diff == -188.20703910797658 -- taskid == [15]
avg_latency == 774.9917654146466 -- greedy == 782.6501557886941 -- diff == 7.658390374047485 -- taskid == [2]
avg_latency == 1072.4107491089412 -- greedy == 899.1789614620208 -- diff == -173.23178764692045 -- taskid == [15]
avg_latency == 955.5104603697504 -- greedy == 827.8765279039657 -- diff == -127.63393246578471 -- taskid == [0]
avg_latency == 731.2175921735491 -- greedy == 796.2377573818479 -- diff == 65.02016520829886 -- taskid == [18]
avg_latency == 1068.7541920083454 -- greedy == 882.3567571518762 -- diff == -186.3974348564692 -- taskid == [12]
avg_latency == 1119.2265971765519 -- greedy == 927.7099499083928 -- diff == -191.5166472681591 -- taskid == [14]
avg_latency == 1052.838359058489 -- greedy == 882.3567571518762 -- diff == -170.4816019066128 -- taskid == [12]
avg_latency == 1046.7884982334817 -- greedy == 882.3567571518762 -- diff == -164.43174108160554 -- taskid == [12]
avg_latency == 1099.3516509974752 -- greedy == 917.1303515739442 -- diff == -182.22129942353104 -- taskid == [13]
avg_latency == 845.2136392051151 -- greedy == 795.2533080208642 -- diff == -49.96033118425089 -- taskid == [17]
avg_latency == 868.86512132646 -- greedy == 808.106911553519 -- diff == -60.75820977294097 -- taskid == [1]
avg_latency == 794.317221352441 -- greedy == 788.8247370971952 -- diff == -5.492484255245813 -- taskid == [4]
avg_latency == 755.5119371868543 -- greedy == 801.0064184761047 -- diff == 45.494481289250416 -- taskid == [8]
avg_latency == 726.4331818144253 -- greedy == 795.3708558062144 -- diff == 68.9376739917891 -- taskid == [7]
avg_latency == 846.199892474842 -- greedy == 795.2533080208642 -- diff == -50.946584453977835 -- taskid == [17]
avg_latency == 713.3529722914424 -- greedy == 795.3708558062144 -- diff == 82.01788351477205 -- taskid == [7]
avg_latency == 777.5647369196756 -- greedy == 803.3178474461694 -- diff == 25.753110526493742 -- taskid == [10]
avg_latency == 1132.0042993107932 -- greedy == 927.7099499083928 -- diff == -204.29434940240037 -- taskid == [14]
avg_latency == 1119.344643561881 -- greedy == 917.1303515739442 -- diff == -202.2142919879368 -- taskid == [13]
avg_latency == 981.3583102715766 -- greedy == 830.3707428888592 -- diff == -150.98756738271732 -- taskid == [5]
avg_latency == 732.1923143236024 -- greedy == 795.3708558062144 -- diff == 63.17854148261199 -- taskid == [7]


 New_teacher == 2401.6175179427987




1


avg_latency == 1147.536489565168 -- greedy == 927.7099499083928 -- diff == -219.82653965677525 -- taskid == [14]
avg_latency == 729.6268110219955 -- greedy == 784.7890609698977 -- diff == 55.16224994790218 -- taskid == [9]
avg_latency == 710.6623427882739 -- greedy == 784.7890609698977 -- diff == 74.1267181816238 -- taskid == [9]
avg_latency == 781.2630716729436 -- greedy == 788.7067359668185 -- diff == 7.443664293874917 -- taskid == [6]
avg_latency == 1125.9442978493553 -- greedy == 917.1303515739442 -- diff == -208.81394627541113 -- taskid == [13]
avg_latency == 789.6191156548499 -- greedy == 803.3178474461694 -- diff == 13.69873179131946 -- taskid == [10]
avg_latency == 877.0833568492891 -- greedy == 808.106911553519 -- diff == -68.97644529577008 -- taskid == [1]
avg_latency == 1114.2053524811608 -- greedy == 917.1303515739442 -- diff == -197.0750009072167 -- taskid == [13]
avg_latency == 726.2100098238943 -- greedy == 796.2377573818479 -- diff == 70.0277475579536 -- taskid == [18]
avg_latency == 840.6862983419418 -- greedy == 775.9840780457088 -- diff == -64.70222029623301 -- taskid == [3]
avg_latency == 735.6060108478002 -- greedy == 801.0064184761047 -- diff == 65.40040762830449 -- taskid == [8]
avg_latency == 772.1634576358523 -- greedy == 782.6501557886941 -- diff == 10.486698152841768 -- taskid == [2]
avg_latency == 779.4523527396748 -- greedy == 788.8247370971952 -- diff == 9.372384357520446 -- taskid == [4]
avg_latency == 987.6343873936653 -- greedy == 830.3707428888592 -- diff == -157.26364450480605 -- taskid == [5]
avg_latency == 836.1322666079931 -- greedy == 775.9840780457088 -- diff == -60.148188562284304 -- taskid == [3]
avg_latency == 711.5290497588838 -- greedy == 796.2377573818479 -- diff == 84.70870762296408 -- taskid == [18]
avg_latency == 1135.5686910559245 -- greedy == 899.1789614620208 -- diff == -236.38972959390378 -- taskid == [15]
avg_latency == 844.7633544450215 -- greedy == 779.0424737050193 -- diff == -65.72088074000214 -- taskid == [11]
avg_latency == 860.2187747772762 -- greedy == 795.2533080208642 -- diff == -64.96546675641196 -- taskid == [17]
avg_latency == 793.0753096537727 -- greedy == 788.7067359668185 -- diff == -4.368573686954164 -- taskid == [6]
avg_latency == 1118.592234653364 -- greedy == 899.1789614620208 -- diff == -219.41327319134314 -- taskid == [15]
avg_latency == 840.3941911189897 -- greedy == 795.2533080208642 -- diff == -45.14088309812553 -- taskid == [17]
avg_latency == 1137.820129590389 -- greedy == 927.7099499083928 -- diff == -210.1101796819961 -- taskid == [14]
avg_latency == 785.0968600499425 -- greedy == 788.8247370971952 -- diff == 3.7278770472527185 -- taskid == [4]
avg_latency == 834.4565830919403 -- greedy == 775.9840780457088 -- diff == -58.472505046231504 -- taskid == [3]
avg_latency == 834.4071002756663 -- greedy == 795.2533080208642 -- diff == -39.153792254802056 -- taskid == [17]
avg_latency == 818.9732724959918 -- greedy == 775.9840780457088 -- diff == -42.98919445028298 -- taskid == [3]